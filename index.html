<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wh4le - Ultimate Hacker Social</title>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-storage.js"></script>
  
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background-color: #121212; color: #fff; }
    .container { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; }
    #chatBox { width: 90%; max-width: 800px; padding: 10px; background-color: #333; border-radius: 8px; margin-bottom: 10px; overflow-y: scroll; height: 300px; }
    .message { margin: 5px; padding: 8px; background-color: #444; border-radius: 6px; }
    .message .meta { font-size: 12px; color: #aaa; }
    .message .actions { display: flex; gap: 10px; font-size: 14px; color: #6200ea; }
    .login-btn, #darkModeBtn { padding: 10px 20px; background-color: #6200ea; border: none; border-radius: 4px; color: white; cursor: pointer; margin: 10px; }
    .login-btn:hover, #darkModeBtn:hover { background-color: #3700b3; }
    .dark-mode { background-color: #121212 !important; color: #fff !important; }
    .light-mode { background-color: #fff !important; color: #000 !important; }
    #messageInput { width: calc(100% - 20px); padding: 10px; border-radius: 4px; margin-top: 10px; }
    .emoji-btn { font-size: 18px; cursor: pointer; }
    .admin-btn { background-color: red; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Welcome to Wh4le - Ultimate Hacker Social</h1>
    <div id="loginSection">
      <button class="login-btn" id="googleLoginBtn">Login with Google</button>
      <br />
      <p>or</p>
      <input type="email" id="emailInput" placeholder="Email" />
      <input type="password" id="passwordInput" placeholder="Password" />
      <button class="login-btn" id="emailLoginBtn">Login with Email</button>
      <button class="login-btn" id="signUpBtn">Sign Up</button>
    </div>

    <div id="chatSection" style="display: none;">
      <button class="login-btn" id="logoutBtn">Logout</button>
      <div id="chatBox"></div>
      <input type="text" id="messageInput" placeholder="Type a message..." />
      <button id="darkModeBtn">Toggle Dark Mode</button>
      <button class="admin-btn" id="adminBtn">Admin Actions</button>
    </div>
  </div>

  <script>
    // Firebase Initialization
    const firebaseConfig = {
      apiKey: "AIzaSyA4D...", // Use your Firebase API key here
      authDomain: "wh4le-d7e9d.firebaseapp.com",
      databaseURL: "https://wh4le-d7e9d-default-rtdb.firebaseio.com/",
      projectId: "wh4le-d7e9d",
      storageBucket: "wh4le-d7e9d.appspot.com",
      messagingSenderId: "465981402247",
      appId: "1:465981402247:web:b55fd08796faa8aba95c22",
      measurementId: "G-4Y49CC6ERN"
    };
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();
    const provider = new firebase.auth.GoogleAuthProvider();

    let currentUser = null;
    let currentServer = "general"; // Placeholder for server context

    // Feature 1: Authentication
    const toggleSections = (isLoggedIn) => {
      if (isLoggedIn) {
        document.getElementById('loginSection').style.display = 'none';
        document.getElementById('chatSection').style.display = 'block';
      } else {
        document.getElementById('loginSection').style.display = 'block';
        document.getElementById('chatSection').style.display = 'none';
      }
    };

    // Save user to DB
    const saveUserToDB = (user) => {
      firebase.database().ref('users/' + user.uid).set({
        username: user.displayName,
        email: user.email,
        profilePicture: user.photoURL || "default_pic_url",
        status: 'online',
        theme: 'dark', // Example of a customizable feature
      });
    };

    // Feature 2: Send Message
    const sendMessage = (message) => {
      if (message.trim() === "") return;
      const messageRef = db.ref('servers/' + currentServer + '/messages').push();
      messageRef.set({
        userId: currentUser.uid,
        message: message,
        timestamp: Date.now(),
      });
    };

    // Feature 3: Display Messages
    const displayMessage = (messageData) => {
      const messageElement = document.createElement('div');
      messageElement.classList.add('message');
      messageElement.innerHTML = `
        <div class="message-content">${messageData.message}</div>
        <div class="meta">Sent by ${messageData.userId} at ${new Date(messageData.timestamp).toLocaleString()}</div>
        <div class="actions">
          <span class="emoji-btn">‚ù§Ô∏è</span> <span class="emoji-btn">üîß</span> <span class="emoji-btn">‚ùå</span>
        </div>
      `;
      document.getElementById('chatBox').appendChild(messageElement);
    };

    // Feature 4: Dark Mode Toggle
    const toggleDarkMode = () => {
      document.body.classList.toggle('dark-mode');
      document.body.classList.toggle('light-mode');
    };

    // Feature 5: Google Login
    const googleLogin = async () => {
      try {
        const result = await firebase.auth().signInWithPopup(provider);
        currentUser = result.user;
        saveUserToDB(currentUser);
        toggleSections(true);
      } catch (error) {
        console.error('Google login error:', error);
        alert('Google login failed. Try again!');
      }
    };

    // Feature 6: Email/Password Login
    const emailLogin = async () => {
      const email = document.getElementById('emailInput').value;
      const password = document.getElementById('passwordInput').value;
      try {
        const result = await firebase.auth().signInWithEmailAndPassword(email, password);
        currentUser = result.user;
        saveUserToDB(currentUser);
        toggleSections(true);
      } catch (error) {
        console.error('Email login error:', error);
        alert('Login failed. Please check your email and password.');
      }
    };

    // Feature 7: Email/Password Sign Up
    const emailSignUp = async () => {
      const email = document.getElementById('emailInput').value;
      const password = document.getElementById('passwordInput').value;
      try {
        const result = await firebase.auth().createUserWithEmailAndPassword(email, password);
        currentUser = result.user;
        saveUserToDB(currentUser);
        toggleSections(true);
      } catch (error) {
        console.error('Sign up error:', error);
        alert('Sign up failed. Try again!');
      }
    };

    // Feature 8: Logout
    const logOut = async () => {
      try {
        await firebase.auth().signOut();
        currentUser = null;
        toggleSections(false);
      } catch (error) {
        console.error('Logout error:', error);
        alert('Logout failed!');
      }
    };

    // Feature 9: Admin Actions (Placeholder)
    const adminActions = () => {
      alert("Admin actions available (e.g., banning, muting users, etc.)");
    };

    // Listen for new messages in real-time
    const listenForMessages = () => {
      db.ref('servers/' + currentServer + '/messages').on('child_added', snapshot => {
        const message = snapshot.val();
        displayMessage(message);
      });
    };

    // Event Listeners
    document.getElementById('googleLoginBtn').addEventListener('click', googleLogin);
    document.getElementById('emailLoginBtn').addEventListener('click', emailLogin);
    document.getElementById('signUpBtn').addEventListener('click', emailSignUp);
    document.getElementById('logoutBtn').addEventListener('click', logOut);
    document.getElementById('darkModeBtn').addEventListener('click', toggleDarkMode);
    document.getElementById('messageInput').addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        sendMessage(e.target.value);
        e.target.value = '';
      }
    });
    document.getElementById('adminBtn').addEventListener('click', adminActions);

    // Check auth state and toggle UI
    firebase.auth().onAuthStateChanged(user => {
      if (user) {
        currentUser = user;
        toggleSections(true);
        listenForMessages();
      } else {
        toggleSections(false);
      }
    });
  </script>
</body>
</html>

